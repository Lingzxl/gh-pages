// leanModal v1.1 by Ray Stone - http://finelysliced.com.au
// Dual licensed under the MIT and GPL
function ismb(){
    var mq = window.matchMedia('(max-width: 614px)');

    if (mq.matches) {
        return true;
    } else {
        return false;
    }
}
(function ($) {
    $.fn.extend({
        leanModal: function (options) {
            var defaults = {top: 100, overlay: 0.5, closeButton: null};
            var overlay = $("<div id='lean_overlay'></div>");
            $("body").append(overlay);
            options = $.extend(defaults, options);
            this.each(function () {
                var o = options;
                $(this).click(function (e) {
                    var modal_id = $(this).attr("href");
                    $(".modal_click").removeClass("modal_click");
                    $(this).addClass("modal_click");
                    $("#lean_overlay").click(function () {
                        close_modal(modal_id);
                    });
                    $(o.closeButton).click(function () {
                        close_modal(modal_id);
                    });
                    var modal_height = $(modal_id).height();
                    var modal_width = $(modal_id).width();
                    $("#lean_overlay").css({"display": "block", opacity: 0});
                    $("#lean_overlay").fadeTo(200, o.overlay);
                    if(ismb()){
                        $(modal_id).css({
                            "display": "block",
                            "position": "fixed",
                            "opacity": 0,
                            "z-index": 11000,
                            "left": 50 + "%",
                            "margin-left": - (modal_width / 2) + "px",
                            "top": o.top + "px"
                        });
                    }else{
                        $(modal_id).css({
                            "display": "block",
                            "position": "fixed",
                            "opacity": 0,
                            "z-index": 11000,
                            "left": 50 + "%",
                            "margin-left": - ((modal_width + 130) / 2) + "px",
                            "top": o.top + "px"
                        });
                    }
                    $(modal_id).fadeTo(200, 1);
                    e.preventDefault();
                })
            });
            function close_modal(modal_id) {
                $("#lean_overlay").fadeOut(200);
                $(modal_id).css({"display": "none"});
            }
        }, showModal: function () {
            $(this).click();
        }, hideModal: function () {
            var modal_id = $(this).attr("href");
            $(modal_id).css({"display": "none"});
        }
    })
})(jQuery);