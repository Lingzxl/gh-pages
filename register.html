<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>注册</title>
        <meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no" name="viewport" id="viewport" />
		<link rel="stylesheet" type="text/css" href="css/amazeui.css">
        <link rel="stylesheet" type="text/css" href="css/pcRegister.css">
	    <link rel="stylesheet" type="text/css" href="css/mRegister.css" media="(max-width:614px)"> 
	    <script type="text/javascript" src="js/device.min.js"></script>
    </head>

    <body>
    	<div class="wrapper">
		<header>
			<h1>如歌</h1>
			<p>分享与挖掘深度好音乐</p>
		</header>

		<div class="content">
	         <div class="message">
	         <div class="error_msg"></div>  
				<form action="http://120.24.14.108:3000/api/v1/signup" method="post">
				    <div class="input">
				        <input type="text" name="name" placeholder="昵称">
						<input type="text" name="account" placeholder="邮箱或手机号">  
						<input type="password" name="password" placeholder="密码"> 
				    </div> 
					<button type="submit" class="btn_login">注册</button>
					<div class="zhuce pcnone">
						<a href="#"><span>登录如歌账号</span></a>
				    </div>
				</form>
	         </div>
		</div>

		<div class="footer">
		    <div class="lz mobilenone">
				<a href="login.html"><span>登录</span></a>
				<span>&middot;</span>
				<a href="register.html">注册</a>
			</div>
			<hr/>
			<span class="text">其他登录方式</span>
			<hr/>
			<!-- <h3 class="title_wrapper">
				<span class="title">其他登录方式</span>
			</h3> -->
            <div class="more">  
				 <a href="#" class="am-icon-btn am-success am-icon-weixin weixin"></a>
				 <a href="#" class="am-icon-btn am-danger am-icon-weibo weibo"></a>
				 <a href="#" class="am-icon-btn am-primary  am-icon-qq qq"></a>
		    </div>
		</div>
	</div>
	<script type="text/javascript" src="jquery/jquery-2.1.3.min.js"></script>
	<script type="text/javascript" src="js/validator.min.js"></script>
	<script type="text/javascript">
  $(document).ready(function() {
  
   $(".error_msg").hide();
   
   $('.btn_login').click(function(e) {     
	    //点击登陆  		     
		var name = $.trim($('input[name=name]').val());  
		var account = $.trim($('input[name=account]').val()); 
		var passwd = $.trim($('input[name=password]').val()); 
		var phone = /^((\(\d{3}\))|(\d{3}\-))?13\d{9}|14[57]\d{8}|15\d{9}|18\d{9}$/ ;
		var mail =/^(?:[a-zA-Z0-9]+[_\-\+\.]?)*[a-zA-Z0-9]+@(?:([a-zA-Z0-9]+[_\-]?)*[a-zA-Z0-9]+\.)+([a-zA-Z]{2,})+$/;

		 alert(name); 
		 alert(account.length); 
		 alert(passwd.length); 
		if (name == '') {   
			$(".error_msg").html('请填写昵称');  
			$(".error_msg").show().fadeOut(3500);
			$('input[name=name]').focus();   
				return false;
		}else if (account == '') {  
			$(".error_msg").html('请填写邮箱或手机号');  
			$(".error_msg").show().fadeOut(3500);  
			$('input[name=password]').focus(); 
			    return false; 
		}else if (passwd == '') {  
			$(".error_msg").html('请填写密码');  
			$(".error_msg").show().fadeOut(3500);  
			$('input[name=password]').focus(); 
			    return false; 
		}else if(!passwd == ''&& passwd.length<6){	
			$(".error_msg").html('密码至少需要6个字符'); 
	        $(".error_msg").show().fadeOut(3500);  
	            return false;
        }else if(!(account == '') && (!account.match(phone) || !account.match(mail))){   
            if((account.match(phone)&& !account.match(mail))||(!account.match(phone)&&account.match(mail))){
            	$(".error_msg").html('手机号正确'); 
                $.ajax({			    
			    type: 'POST',// 请求发送方式			    
			    url: 'http://120.24.14.108:3000/api/v1/signup',// 验证文件			    
			    data: {'name': name, 'mobile': account,'pass': passwd},// 用户输入的帐号密码			    
			    async: true,// 异步，不写默认为True
			    //请求成功后的回调
			    success: function(data){
			    	  alert(JSON.stringify(data));
			          window.location.href="index.html";
			    },
			    //请求失败后的回调
			    error: function(data){
			    	  alert(JSON.stringify(data));
				      var tmp='<span>'+data.responseJSON.errmsg+'</span>';
				      $('.error_msg').empty();
			          $('.error_msg').append(tmp);
			          $(".error_msg").show().fadeOut(3500);   
			          window.location.href="#";      
			    }
		      });            
            }else if(!account.match(phone)&& !account.match(mail)){
            	$(".error_msg").html('请输入正确的邮箱或手机号'); 
		        $(".error_msg").show().fadeOut(3500); 
		          return false; 
            }                               
        }
		 e.preventDefault();
    }); 

 });

	</script>

	
    </body>
</html>